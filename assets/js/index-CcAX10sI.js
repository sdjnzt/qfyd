import{d as ge,a as c,Z as M,i as Y,z as fe,B as $,w as _e,C as Z,e as ye,k as n,j as t,b as a,r as i,t as g,m as G,x as ve,q as d,ai as be,X as I,Y as Be,o as Te}from"./vendor-CgAfaZZC.js";import{_ as Se}from"./index-BrFT0OYg.js";const he={class:"storage-container"},Ce={class:"card-header"},xe={class:"header-left"},Ve={class:"header-right"},we={class:"stat-box"},Pe={class:"stat-box"},Ae={class:"stat-value"},ke={class:"stat-box"},Ne={class:"stat-value warning"},De={class:"card-header"},ze={class:"header-left"},Oe={class:"card-header"},Ue={class:"header-actions"},je={class:"pagination-container"},$e={class:"dialog-footer"},Ie=ge({__name:"index",setup(Re){const C=c(""),x=c(1),k=c(10),R=c("day"),F=M({day:{used:19,warning:4},week:{used:18,warning:5},month:{used:18,warning:6}}),P=c(F.day),r=c([{id:1,name:"主存储阵列A",type:"SAN",capacity:"50TB",used:"30TB",usedPercentage:60,location:"主机房",status:"正常"},{id:2,name:"主存储阵列B",type:"SAN",capacity:"50TB",used:"28TB",usedPercentage:56,location:"主机房",status:"正常"},{id:3,name:"备份存储A",type:"NAS",capacity:"30TB",used:"20TB",usedPercentage:67,location:"备份机房",status:"正常"},{id:4,name:"备份存储B",type:"NAS",capacity:"30TB",used:"22TB",usedPercentage:73,location:"备份机房",status:"警告"},{id:5,name:"归档存储",type:"Object Storage",capacity:"100TB",used:"65TB",usedPercentage:65,location:"数据中心",status:"正常"},{id:6,name:"分布式存储A",type:"分布式",capacity:"50TB",used:"22TB",usedPercentage:44,location:"主机房",status:"正常"},{id:7,name:"分布式存储B",type:"分布式",capacity:"50TB",used:"18TB",usedPercentage:36,location:"主机房",status:"正常"},{id:8,name:"教学资源存储",type:"NAS",capacity:"30TB",used:"25TB",usedPercentage:83,location:"主机房",status:"警告"},{id:9,name:"研究数据存储",type:"SAN",capacity:"40TB",used:"15TB",usedPercentage:38,location:"研究中心",status:"正常"},{id:10,name:"云备份存储",type:"Object Storage",capacity:"80TB",used:"50TB",usedPercentage:62,location:"云中心",status:"正常"},{id:11,name:"高性能计算存储",type:"SAN",capacity:"20TB",used:"12TB",usedPercentage:60,location:"科研中心",status:"正常"},{id:12,name:"容灾备份存储",type:"Object Storage",capacity:"60TB",used:"35TB",usedPercentage:58,location:"容灾中心",status:"正常"},{id:13,name:"虚拟化存储池",type:"分布式",capacity:"40TB",used:"28TB",usedPercentage:70,location:"主机房",status:"正常"},{id:14,name:"媒体资源存储",type:"NAS",capacity:"25TB",used:"20TB",usedPercentage:80,location:"媒体中心",status:"警告"},{id:15,name:"实验数据存储",type:"SAN",capacity:"15TB",used:"10TB",usedPercentage:67,location:"实验楼",status:"正常"},{id:16,name:"学生作品存储",type:"NAS",capacity:"10TB",used:"8TB",usedPercentage:80,location:"教学楼",status:"警告"},{id:17,name:"图书馆存储",type:"NAS",capacity:"20TB",used:"15TB",usedPercentage:75,location:"图书馆",status:"正常"},{id:18,name:"远程备份存储",type:"Object Storage",capacity:"50TB",used:"30TB",usedPercentage:60,location:"远程机房",status:"正常"},{id:19,name:"档案资料存储",type:"NAS",capacity:"30TB",used:"18TB",usedPercentage:60,location:"档案室",status:"警告"}]),L=Y(()=>C.value?r.value.filter(l=>l.name.includes(C.value)||l.type.includes(C.value)||l.location.includes(C.value)):r.value),H=Y(()=>{const l=(x.value-1)*k.value;return L.value.slice(l,l+k.value)});let N=null,D=null;const q=c(null),E=c(null);fe(()=>{$(()=>{z()})}),_e(R,l=>{P.value=F[l],I.success(`已切换到${l==="day"?"今日":l==="week"?"本周":"本月"}数据`),z()});function z(){$(()=>{try{if(q.value){N&&N.dispose(),N=Z(q.value);const l=r.value.filter(o=>o.status==="正常").length,e=r.value.filter(o=>o.status==="警告").length,m=r.value.filter(o=>o.status==="错误").length,B=r.value.filter(o=>o.status==="离线").length;N.setOption({title:{text:"存储设备状态分布",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{bottom:"5%",left:"center"},series:[{name:"设备状态",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!0,fontSize:"16",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:l,name:"正常",itemStyle:{color:"#67C23A"}},{value:e,name:"警告",itemStyle:{color:"#E6A23C"}},{value:m,name:"错误",itemStyle:{color:"#F56C6C"}},{value:B,name:"离线",itemStyle:{color:"#909399"}}]}]})}if(E.value){D&&D.dispose(),D=Z(E.value);const l={};r.value.forEach(o=>{const y=parseInt(o.capacity.replace(/[^0-9]/g,"")),p=parseInt(o.used.replace(/[^0-9]/g,""));l[o.type]||(l[o.type]={total:0,used:0}),l[o.type].total+=y,l[o.type].used+=p});const e=Object.keys(l),m=e.map(o=>l[o].total),B=e.map(o=>l[o].used);D.setOption({title:{text:"存储容量使用情况",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(o){const y=o[0].dataIndex,p=e[y],A=l[p].total,w=l[p].used,v=Math.round(w/A*100);return`${p}<br/>总容量: ${A}TB<br/>已使用: ${w}TB (${v}%)`}},legend:{data:["总容量","已使用"],bottom:"5%"},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:e},yAxis:{type:"value",name:"容量(TB)"},series:[{name:"总容量",type:"bar",emphasis:{focus:"series"},data:m,itemStyle:{color:"#409EFF"}},{name:"已使用",type:"bar",emphasis:{focus:"series"},data:B,itemStyle:{color:"#67C23A"}}]})}}catch(l){console.error("初始化图表失败:",l)}})}function J(){x.value=1}function K(l){k.value=l,x.value=1}function ee(l){x.value=l}const te=l=>l>80?"exception":l>60?"warning":"success",ae=l=>{switch(l){case"正常":return"success";case"离线":return"info";case"错误":return"danger";case"警告":return"warning";default:return"info"}},V=c(!1),O=c("add"),u=M({id:0,name:"",type:"",capacity:"",used:"",usedPercentage:0,location:"",status:"正常"}),U=c(),le={name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],capacity:[{required:!0,message:"请输入总容量",trigger:"blur"}],used:[{required:!0,message:"请输入已用容量",trigger:"blur"}],usedPercentage:[{required:!0,type:"number",message:"请输入使用率",trigger:"blur"}],location:[{required:!0,message:"请输入位置",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]};function se(){O.value="add";const l=Math.max(...r.value.map(e=>e.id),0);Object.assign(u,{id:l+1,name:"",type:"",capacity:"",used:"",usedPercentage:0,location:"",status:"正常"}),V.value=!0,$(()=>{var e;return(e=U.value)==null?void 0:e.clearValidate()})}function ne(l){O.value="edit",Object.assign(u,l),V.value=!0,$(()=>{var e;return(e=U.value)==null?void 0:e.clearValidate()})}function oe(){U.value.validate(l=>{if(l){if(O.value==="add")r.value.unshift({...u}),I.success("新增成功");else{const e=r.value.findIndex(m=>m.id===u.id);e!==-1&&(r.value[e]={...u},I.success("编辑成功"))}V.value=!1,z()}})}function ue(l){Be.confirm(`确定要删除存储设备"${l.name}"吗？`,"删除确认",{type:"warning"}).then(()=>{const e=r.value.findIndex(m=>m.id===l.id);e!==-1&&(r.value.splice(e,1),I.success("删除成功"),z())}).catch(()=>{})}const j=c(!1),_=M({name:"",type:"",capacity:"",used:"",usedPercentage:0,location:"",status:""});function ie(l){Object.assign(_,l),j.value=!0}return(l,e)=>{const m=i("el-icon"),B=i("el-radio-button"),o=i("el-radio-group"),y=i("el-progress"),p=i("el-col"),A=i("el-row"),w=i("el-card"),v=i("el-input"),T=i("el-button"),f=i("el-table-column"),de=i("el-tag"),re=i("el-table"),ce=i("el-pagination"),S=i("el-form-item"),b=i("el-option"),W=i("el-select"),pe=i("el-form"),Q=i("el-dialog"),h=i("el-descriptions-item"),me=i("el-descriptions");return Te(),ye("div",he,[e[30]||(e[30]=n("h1",null,"存储管理",-1)),t(w,{class:"license-card",shadow:"hover"},{header:a(()=>[n("div",Ce,[n("div",xe,[t(m,null,{default:a(()=>[t(G(ve))]),_:1}),e[14]||(e[14]=n("span",null,"存储设备许可概览",-1))]),n("div",Ve,[t(o,{modelValue:R.value,"onUpdate:modelValue":e[0]||(e[0]=s=>R.value=s),size:"small"},{default:a(()=>[t(B,{label:"day"},{default:a(()=>e[15]||(e[15]=[d("今日")])),_:1,__:[15]}),t(B,{label:"week"},{default:a(()=>e[16]||(e[16]=[d("本周")])),_:1,__:[16]}),t(B,{label:"month"},{default:a(()=>e[17]||(e[17]=[d("本月")])),_:1,__:[17]})]),_:1},8,["modelValue"])])])]),default:a(()=>[t(A,{gutter:20},{default:a(()=>[t(p,{span:8},{default:a(()=>[n("div",we,[e[18]||(e[18]=n("div",{class:"stat-title"},"许可总数",-1)),e[19]||(e[19]=n("div",{class:"stat-value"},"20",-1)),t(y,{percentage:100,status:"success"})])]),_:1}),t(p,{span:8},{default:a(()=>[n("div",Pe,[e[20]||(e[20]=n("div",{class:"stat-title"},"已使用",-1)),n("div",Ae,g(P.value.used),1),t(y,{percentage:P.value.used/20*100,status:"success"},null,8,["percentage"])])]),_:1}),t(p,{span:8},{default:a(()=>[n("div",ke,[e[21]||(e[21]=n("div",{class:"stat-title"},"告警设备",-1)),n("div",Ne,g(P.value.warning),1),t(y,{percentage:P.value.warning/20*100,status:"warning"},null,8,["percentage"])])]),_:1})]),_:1})]),_:1}),t(w,{class:"storage-stats-card",shadow:"hover"},{header:a(()=>[n("div",De,[n("div",ze,[t(m,null,{default:a(()=>[t(G(be))]),_:1}),e[22]||(e[22]=n("span",null,"存储设备状态分析",-1))])])]),default:a(()=>[t(A,{gutter:20},{default:a(()=>[t(p,{span:12},{default:a(()=>[n("div",{ref_key:"statusChartRef",ref:q,class:"chart-container"},null,512)]),_:1}),t(p,{span:12},{default:a(()=>[n("div",{ref_key:"usageChartRef",ref:E,class:"chart-container"},null,512)]),_:1})]),_:1})]),_:1}),t(w,{class:"storage-card"},{header:a(()=>[n("div",Oe,[n("div",Ue,[t(v,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=s=>C.value=s),placeholder:"搜索存储设备（名称/类型/位置）...",clearable:"","prefix-icon":"Search",style:{width:"300px","margin-right":"10px"},onInput:J},null,8,["modelValue"]),t(T,{type:"primary",onClick:se},{default:a(()=>e[23]||(e[23]=[d("新增存储设备")])),_:1,__:[23]})])])]),default:a(()=>[t(re,{data:H.value,style:{width:"100%"},border:"",stripe:"","highlight-current-row":""},{default:a(()=>[t(f,{prop:"id",label:"ID",width:"80"}),t(f,{prop:"name",label:"设备名称","min-width":"150"}),t(f,{prop:"type",label:"类型",width:"120"}),t(f,{prop:"capacity",label:"总容量",width:"120"}),t(f,{prop:"used",label:"已用容量",width:"120"}),t(f,{prop:"usedPercentage",label:"使用率",width:"120"},{default:a(({row:s})=>[t(y,{percentage:s.usedPercentage,status:te(s.usedPercentage),format:()=>s.usedPercentage+"%"},null,8,["percentage","status","format"])]),_:1}),t(f,{prop:"location",label:"位置",width:"150"}),t(f,{prop:"status",label:"状态",width:"100"},{default:a(({row:s})=>[t(de,{type:ae(s.status)},{default:a(()=>[d(g(s.status),1)]),_:2},1032,["type"])]),_:1}),t(f,{label:"操作",width:"220",fixed:"right"},{default:a(({row:s})=>[t(T,{type:"primary",size:"small",onClick:X=>ie(s)},{default:a(()=>e[24]||(e[24]=[d("查看")])),_:2,__:[24]},1032,["onClick"]),t(T,{type:"warning",size:"small",onClick:X=>ne(s)},{default:a(()=>e[25]||(e[25]=[d("编辑")])),_:2,__:[25]},1032,["onClick"]),t(T,{type:"danger",size:"small",onClick:X=>ue(s)},{default:a(()=>e[26]||(e[26]=[d("删除")])),_:2,__:[26]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),n("div",je,[t(ce,{"current-page":x.value,"onUpdate:currentPage":e[2]||(e[2]=s=>x.value=s),"page-size":k.value,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:L.value.length,onSizeChange:K,onCurrentChange:ee},null,8,["current-page","page-size","total"])])]),_:1}),t(Q,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=s=>V.value=s),title:O.value==="add"?"新增存储设备":"编辑存储设备",width:"500px"},{footer:a(()=>[n("span",$e,[t(T,{onClick:e[10]||(e[10]=s=>V.value=!1)},{default:a(()=>e[27]||(e[27]=[d("取消")])),_:1,__:[27]}),t(T,{type:"primary",onClick:oe},{default:a(()=>e[28]||(e[28]=[d("确定")])),_:1,__:[28]})])]),default:a(()=>[t(pe,{model:u,rules:le,ref_key:"editFormRef",ref:U,"label-width":"100px"},{default:a(()=>[t(S,{label:"设备名称",prop:"name"},{default:a(()=>[t(v,{modelValue:u.name,"onUpdate:modelValue":e[3]||(e[3]=s=>u.name=s)},null,8,["modelValue"])]),_:1}),t(S,{label:"类型",prop:"type"},{default:a(()=>[t(W,{modelValue:u.type,"onUpdate:modelValue":e[4]||(e[4]=s=>u.type=s),placeholder:"请选择"},{default:a(()=>[t(b,{label:"SAN",value:"SAN"}),t(b,{label:"NAS",value:"NAS"}),t(b,{label:"Object Storage",value:"Object Storage"}),t(b,{label:"分布式",value:"分布式"})]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"总容量",prop:"capacity"},{default:a(()=>[t(v,{modelValue:u.capacity,"onUpdate:modelValue":e[5]||(e[5]=s=>u.capacity=s)},null,8,["modelValue"])]),_:1}),t(S,{label:"已用容量(%)",prop:"usedPercentage"},{default:a(()=>[t(v,{modelValue:u.usedPercentage,"onUpdate:modelValue":e[6]||(e[6]=s=>u.usedPercentage=s),modelModifiers:{number:!0},type:"number",min:"0",max:"100"},null,8,["modelValue"])]),_:1}),t(S,{label:"已用容量",prop:"used"},{default:a(()=>[t(v,{modelValue:u.used,"onUpdate:modelValue":e[7]||(e[7]=s=>u.used=s)},null,8,["modelValue"])]),_:1}),t(S,{label:"位置",prop:"location"},{default:a(()=>[t(v,{modelValue:u.location,"onUpdate:modelValue":e[8]||(e[8]=s=>u.location=s)},null,8,["modelValue"])]),_:1}),t(S,{label:"状态",prop:"status"},{default:a(()=>[t(W,{modelValue:u.status,"onUpdate:modelValue":e[9]||(e[9]=s=>u.status=s),placeholder:"请选择"},{default:a(()=>[t(b,{label:"正常",value:"正常"}),t(b,{label:"离线",value:"离线"}),t(b,{label:"错误",value:"错误"}),t(b,{label:"警告",value:"警告"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(Q,{modelValue:j.value,"onUpdate:modelValue":e[13]||(e[13]=s=>j.value=s),title:"存储设备详情",width:"400px","show-close":!0},{footer:a(()=>[t(T,{onClick:e[12]||(e[12]=s=>j.value=!1)},{default:a(()=>e[29]||(e[29]=[d("关闭")])),_:1,__:[29]})]),default:a(()=>[t(me,{column:1,border:""},{default:a(()=>[t(h,{label:"设备名称"},{default:a(()=>[d(g(_.name),1)]),_:1}),t(h,{label:"类型"},{default:a(()=>[d(g(_.type),1)]),_:1}),t(h,{label:"总容量"},{default:a(()=>[d(g(_.capacity),1)]),_:1}),t(h,{label:"已用容量"},{default:a(()=>[d(g(_.used),1)]),_:1}),t(h,{label:"使用率"},{default:a(()=>[d(g(_.usedPercentage)+"%",1)]),_:1}),t(h,{label:"位置"},{default:a(()=>[d(g(_.location),1)]),_:1}),t(h,{label:"状态"},{default:a(()=>[d(g(_.status),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Me=Se(Ie,[["__scopeId","data-v-40d2e65a"]]);export{Me as default};
