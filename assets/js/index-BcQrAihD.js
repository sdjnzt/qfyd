import{d as K,a as b,i as S,Z as I,e as L,k as B,j as e,b as t,r as o,q as n,t as c,B as T,X as U,Y as W,o as ee}from"./vendor-BCCqDdhU.js";import{_ as ae}from"./index-CBMaVkck.js";const te={class:"backup-container"},le={class:"card-header"},se={class:"header-actions"},ue={class:"pagination-container"},ne={class:"dialog-footer"},oe=K({__name:"index",setup(de){const v=b(""),k=b(1),x=b(10),m=b([{id:1,name:"学生数据库备份",type:"完整备份",source:"/data/student_db",destination:"/backup/student_db",schedule:"每日",status:"启用",lastBackup:"2025-06-15 02:00:00",nextBackup:"2025-06-16 02:00:00"},{id:2,name:"教务系统备份",type:"完整备份",source:"/data/academic_sys",destination:"/backup/academic_sys",schedule:"每日",status:"启用",lastBackup:"2025-06-15 03:00:00",nextBackup:"2025-06-16 03:00:00"},{id:3,name:"财务系统备份",type:"完整备份",source:"/data/finance_sys",destination:"/backup/finance_sys",schedule:"每日",status:"启用",lastBackup:"2025-06-15 04:00:00",nextBackup:"2025-06-16 04:00:00"},{id:4,name:"教学资源备份",type:"增量备份",source:"/data/teaching_resources",destination:"/backup/teaching_resources",schedule:"每周",status:"启用",lastBackup:"2025-06-14 01:00:00",nextBackup:"2025-06-21 01:00:00"},{id:5,name:"人事档案备份",type:"完整备份",source:"/data/hr_records",destination:"/backup/hr_records",schedule:"每周",status:"启用",lastBackup:"2025-06-13 02:00:00",nextBackup:"2025-06-20 02:00:00"},{id:6,name:"系统日志备份",type:"日志备份",source:"/var/log",destination:"/backup/system_logs",schedule:"每日",status:"启用",lastBackup:"2025-06-15 01:00:00",nextBackup:"2025-06-16 01:00:00"},{id:7,name:"网站文件备份",type:"差异备份",source:"/var/www",destination:"/backup/website_files",schedule:"每周",status:"启用",lastBackup:"2025-06-12 03:00:00",nextBackup:"2025-06-19 03:00:00"},{id:8,name:"邮件系统备份",type:"完整备份",source:"/data/mail_system",destination:"/backup/mail_system",schedule:"每日",status:"错误",lastBackup:"2025-06-14 05:00:00",nextBackup:"2025-06-15 05:00:00"},{id:9,name:"图书馆系统备份",type:"完整备份",source:"/data/library_sys",destination:"/backup/library_sys",schedule:"每日",status:"运行中",lastBackup:"2025-06-15 06:00:00",nextBackup:"2025-06-16 06:00:00"},{id:10,name:"研究数据备份",type:"增量备份",source:"/data/research_data",destination:"/backup/research_data",schedule:"每月",status:"禁用",lastBackup:"2025-06-01 02:00:00",nextBackup:"2025-02-01 02:00:00"}]),z=S(()=>v.value?m.value.filter(s=>s.name.includes(v.value)||s.type.includes(v.value)||s.status.includes(v.value)):m.value),$=S(()=>{const s=(k.value-1)*x.value;return z.value.slice(s,s+x.value)});function j(){k.value=1}function E(s){x.value=s,k.value=1}function M(s){k.value=s}const F=s=>{switch(s){case"启用":return"success";case"禁用":return"info";case"错误":return"danger";case"运行中":return"warning";default:return"info"}},y=b(!1),V=b("add"),u=I({id:0,name:"",type:"",source:"",destination:"",schedule:"",status:"启用",lastBackup:"",nextBackup:""}),h=b(),N={name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],source:[{required:!0,message:"请输入备份源",trigger:"blur"}],destination:[{required:!0,message:"请输入备份目标",trigger:"blur"}],schedule:[{required:!0,message:"请选择执行计划",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],lastBackup:[{required:!0,message:"请输入最后备份时间",trigger:"blur"}],nextBackup:[{required:!0,message:"请输入下次备份时间",trigger:"blur"}]};function O(){V.value="add";const s=Math.max(...m.value.map(a=>a.id),0);Object.assign(u,{id:s+1,name:"",type:"",source:"",destination:"",schedule:"",status:"启用",lastBackup:"",nextBackup:""}),y.value=!0,T(()=>{var a;return(a=h.value)==null?void 0:a.clearValidate()})}function R(s){V.value="edit",Object.assign(u,s),y.value=!0,T(()=>{var a;return(a=h.value)==null?void 0:a.clearValidate()})}function P(){h.value.validate(s=>{if(s){if(V.value==="add")m.value.unshift({...u}),U.success("新增成功");else{const a=m.value.findIndex(i=>i.id===u.id);a!==-1&&(m.value[a]={...u},U.success("编辑成功"))}y.value=!1}})}function A(s){W.confirm(`确定要删除备份任务"${s.name}"吗？`,"删除确认",{type:"warning"}).then(()=>{const a=m.value.findIndex(i=>i.id===s.id);a!==-1&&(m.value.splice(a,1),U.success("删除成功"))}).catch(()=>{})}const w=b(!1),p=I({name:"",type:"",source:"",destination:"",schedule:"",status:"",lastBackup:"",nextBackup:""});function Q(s){Object.assign(p,s),w.value=!0}return(s,a)=>{const i=o("el-input"),g=o("el-button"),r=o("el-table-column"),X=o("el-tag"),Y=o("el-table"),Z=o("el-pagination"),G=o("el-card"),_=o("el-form-item"),d=o("el-option"),C=o("el-select"),H=o("el-form"),q=o("el-dialog"),f=o("el-descriptions-item"),J=o("el-descriptions");return ee(),L("div",te,[a[21]||(a[21]=B("h1",null,"备份管理",-1)),e(G,{class:"backup-card"},{header:t(()=>[B("div",le,[B("div",se,[e(i,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=l=>v.value=l),placeholder:"搜索备份任务（名称/类型/状态）...",clearable:"","prefix-icon":"Search",style:{width:"300px","margin-right":"10px"},onInput:j},null,8,["modelValue"]),e(g,{type:"primary",onClick:O},{default:t(()=>a[14]||(a[14]=[n("新增备份任务")])),_:1,__:[14]})])])]),default:t(()=>[e(Y,{data:$.value,style:{width:"100%"},border:"",stripe:"","highlight-current-row":""},{default:t(()=>[e(r,{prop:"id",label:"ID",width:"80"}),e(r,{prop:"name",label:"任务名称","min-width":"150"}),e(r,{prop:"type",label:"类型",width:"120"}),e(r,{prop:"source",label:"备份源",width:"150"}),e(r,{prop:"destination",label:"备份目标",width:"150"}),e(r,{prop:"schedule",label:"执行计划",width:"120"}),e(r,{prop:"status",label:"状态",width:"100"},{default:t(({row:l})=>[e(X,{type:F(l.status)},{default:t(()=>[n(c(l.status),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"lastBackup",label:"最后备份",width:"150"}),e(r,{prop:"nextBackup",label:"下次备份",width:"150"}),e(r,{label:"操作",width:"220",fixed:"right"},{default:t(({row:l})=>[e(g,{type:"primary",size:"small",onClick:D=>Q(l)},{default:t(()=>a[15]||(a[15]=[n("查看")])),_:2,__:[15]},1032,["onClick"]),e(g,{type:"warning",size:"small",onClick:D=>R(l)},{default:t(()=>a[16]||(a[16]=[n("编辑")])),_:2,__:[16]},1032,["onClick"]),e(g,{type:"danger",size:"small",onClick:D=>A(l)},{default:t(()=>a[17]||(a[17]=[n("删除")])),_:2,__:[17]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),B("div",ue,[e(Z,{"current-page":k.value,"onUpdate:currentPage":a[1]||(a[1]=l=>k.value=l),"page-size":x.value,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:z.value.length,onSizeChange:E,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1}),e(q,{modelValue:y.value,"onUpdate:modelValue":a[11]||(a[11]=l=>y.value=l),title:V.value==="add"?"新增备份任务":"编辑备份任务",width:"500px"},{footer:t(()=>[B("span",ne,[e(g,{onClick:a[10]||(a[10]=l=>y.value=!1)},{default:t(()=>a[18]||(a[18]=[n("取消")])),_:1,__:[18]}),e(g,{type:"primary",onClick:P},{default:t(()=>a[19]||(a[19]=[n("确定")])),_:1,__:[19]})])]),default:t(()=>[e(H,{model:u,rules:N,ref_key:"editFormRef",ref:h,"label-width":"100px"},{default:t(()=>[e(_,{label:"任务名称",prop:"name"},{default:t(()=>[e(i,{modelValue:u.name,"onUpdate:modelValue":a[2]||(a[2]=l=>u.name=l)},null,8,["modelValue"])]),_:1}),e(_,{label:"类型",prop:"type"},{default:t(()=>[e(C,{modelValue:u.type,"onUpdate:modelValue":a[3]||(a[3]=l=>u.type=l),placeholder:"请选择"},{default:t(()=>[e(d,{label:"完整备份",value:"完整备份"}),e(d,{label:"增量备份",value:"增量备份"}),e(d,{label:"差异备份",value:"差异备份"}),e(d,{label:"日志备份",value:"日志备份"})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"备份源",prop:"source"},{default:t(()=>[e(i,{modelValue:u.source,"onUpdate:modelValue":a[4]||(a[4]=l=>u.source=l)},null,8,["modelValue"])]),_:1}),e(_,{label:"备份目标",prop:"destination"},{default:t(()=>[e(i,{modelValue:u.destination,"onUpdate:modelValue":a[5]||(a[5]=l=>u.destination=l)},null,8,["modelValue"])]),_:1}),e(_,{label:"执行计划",prop:"schedule"},{default:t(()=>[e(C,{modelValue:u.schedule,"onUpdate:modelValue":a[6]||(a[6]=l=>u.schedule=l),placeholder:"请选择"},{default:t(()=>[e(d,{label:"每日",value:"每日"}),e(d,{label:"每周",value:"每周"}),e(d,{label:"每月",value:"每月"}),e(d,{label:"手动",value:"手动"})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"状态",prop:"status"},{default:t(()=>[e(C,{modelValue:u.status,"onUpdate:modelValue":a[7]||(a[7]=l=>u.status=l),placeholder:"请选择"},{default:t(()=>[e(d,{label:"启用",value:"启用"}),e(d,{label:"禁用",value:"禁用"}),e(d,{label:"错误",value:"错误"}),e(d,{label:"运行中",value:"运行中"})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"最后备份",prop:"lastBackup"},{default:t(()=>[e(i,{modelValue:u.lastBackup,"onUpdate:modelValue":a[8]||(a[8]=l=>u.lastBackup=l)},null,8,["modelValue"])]),_:1}),e(_,{label:"下次备份",prop:"nextBackup"},{default:t(()=>[e(i,{modelValue:u.nextBackup,"onUpdate:modelValue":a[9]||(a[9]=l=>u.nextBackup=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(q,{modelValue:w.value,"onUpdate:modelValue":a[13]||(a[13]=l=>w.value=l),title:"备份任务详情",width:"400px","show-close":!0},{footer:t(()=>[e(g,{onClick:a[12]||(a[12]=l=>w.value=!1)},{default:t(()=>a[20]||(a[20]=[n("关闭")])),_:1,__:[20]})]),default:t(()=>[e(J,{column:1,border:""},{default:t(()=>[e(f,{label:"任务名称"},{default:t(()=>[n(c(p.name),1)]),_:1}),e(f,{label:"类型"},{default:t(()=>[n(c(p.type),1)]),_:1}),e(f,{label:"备份源"},{default:t(()=>[n(c(p.source),1)]),_:1}),e(f,{label:"备份目标"},{default:t(()=>[n(c(p.destination),1)]),_:1}),e(f,{label:"执行计划"},{default:t(()=>[n(c(p.schedule),1)]),_:1}),e(f,{label:"状态"},{default:t(()=>[n(c(p.status),1)]),_:1}),e(f,{label:"最后备份"},{default:t(()=>[n(c(p.lastBackup),1)]),_:1}),e(f,{label:"下次备份"},{default:t(()=>[n(c(p.nextBackup),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),pe=ae(oe,[["__scopeId","data-v-71aaa71e"]]);export{pe as default};
